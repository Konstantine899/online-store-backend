# Repositories

В repositories происходит взаимодействие с БД. Для взаимодействия с реляционной БД используется ORM Sequelize. Более
подробно можно ознакомится в официальной документации [sequelize.org](https://sequelize.org/).

В constructor каждого репозитория как зависимость внедряем необходимые модели данных.

### BrandRepository

Класс имплементирует IBrandRepository.

- `createBrand` - метод с помощью которого создается brand в БД
- `findListAllBrands` - метод с помощью которого происходит поиск списка всех брендов в БД
- `findBrand` - метод с помощью которого происходит поиск бренда в БД
- `updateBrand` - метод с помощью которого происходит обновление бренда в БД
- `removeBrand` - метод с помощью которого происходит удаление бренда из БД

### CartRepository

Класс имплементирует ICartRepository

- `findCart` - поиск корзины. Поиск осуществляется по id корзины. Корзина должна включать такие аттрибуты, из модели
  ProductModel, как id name price.
- `createCart` - метод с помощью которого происходит создание корзины
- `appendToCart` - метод с помощью которого происходит добавление товара в корзину. Аргументами принимает id корзины, id
  продукта и quantity количество. Сначала происходит поиск корзины и содержащегося в ней товара. Если корзина не
  найдена, то мы ее создаем в БД. После чего производим поиск товара в корзине. Если товар найден. Если товар найден, то
  производим инкрементное увеличение количества товара в корзине. Если же товара нет в корзине мы его создаем с помощью
  метода create. Для того что бы получить свежие данные из БД использую метод reload. И только после этого возвращаю
  свежие данные из БД.
- `increment` - метод с помощью которого производим инкрементное увеличение количества товара в корзине.
- `decrement` - метод с помощью которого производим декрементное уменьшение количества товара в корзине.
- `removeFromCart` - метод с помощью которого производим удаление позиции товара из корзины
- `clearCart` - метод с помощью которого производим очистку всех позиций товара из корзины

### CategoryRepository

Класс имплементирует ICategoryRepository

- `createCategory` - метод с помощью которого производим создание категории в БД
- `findListAllCategories` - метод с помощью которого производим поиск списка всех категорий в БД
- `findCategory` - метод с помощью которого производим поиск категории в БД
- `updateCategory` - метод с помощью которого производим обновление категории в БД
- `removeCategory` - метод с помощью которого производим удалении категории из БД

### OrderRepository

Класс имплементирует IOrderRepository

- `adminFindOrderListUser` - метод, который используется пользователями с ролью ADMIN, для поиска списка всех заказов
  пользователя.
- `adminFindOrderUser` - метод, который используется пользователями с ролью ADMIN, для поиска заказа пользователя
- `findUserAndHisOrders` - поиск всех заказов пользователя
- `adminCreateOrder` - метод, который используется пользователями с ролью ADMIN, для создания заказа
- `findOrder` - поиск заказа
- `removeOrder` - удаление заказа
- `userFindOrderList` - метод, который используется пользователями с ролью USER, поиск списка заказов
- `userFindOrder` - метод, который используется пользователями с ролью USER, поиск заказа
- `createOrder` - метод, который используется пользователями с ролью USER, создание заказа

### OrderItemRepository

Класс имплементирует IOrderItemRepository

- `createItem` - метод с помощью которого создается позиция заказа

### ProductRepository

Класс имплементирует IProductRepository

- `create` - метод создания продукта
- `fidProductByPkId` - метод с помощью которого происходит поиск определенного товара по id
- `findProductProperty` - метод с помощью которого происходит поиск всех свойств продукта
- `findListProduct` - метод с помощью которого происходит поиск всех продуктов и сортировка по цене
- `findListProductByBrandId` - метод с помощью которого происходит поиск всех продуктов по id бренда, а так же
  сортировка их по цене
- `findListProductByCategoryId` - метод с помощью которого происходит поиск всех продуктов по id категории, а так же
  сортировка их по цене
- `findAllByBrandIdAndCategoryId` - метод с помощью которого происходит поиск всех продуктов по id бренда и категории, а
  так же сортировка их по цене
- `removedProduct` - метод с помощью которого происходит удаление продукта
- `updateProduct` - метод с помощью которого происходит обновление продукта

### ProductPropertyRepository

Класс имплементирует IProductPropertyRepository

- `create` - создание свойство продукта
- `findOneProductProperty` - получение одного свойства продукта
- `findListProductProperty` - получение списка всех свойств продукта
- `updateProductProperty` - обновление свойства продукта
- `removeProductProperty` - удаление свойства продукта

### RatingRepository

Класс имплементирует IRatingRepository

- `createRating` - создание рейтинга
- `findVote` - метод с помощью которого находим голос пользователя
- `countRating` - метод который находит количество оценок
- `ratingsSum` - метод который суммирует все оценки находящиеся в БД

### RefreshTokenRepository

Класс имплементирует IRefreshTokenRepository

- `createRefreshToken` - создание refresh token 
- `findRefreshTokenById` - поиск refresh token по id
- `findListRefreshTokens` - поиск списка refresh tokens
- `removeListRefreshTokens` - удаление списка refresh tokens
- `removeRefreshToken` - удаление refresh token


### RoleRepository

Класс имплементирует IRoleRepository

- `createRole` - создать роль
- `findRole` - найти роль
- `findListRole` - найти список ролей

### UserRepository

Класс имплементирует IUserRepository

- `createUser` - создает пользователя в БД
- `updateUser` - обновляет пользователя в БД
- `findUser` - поиск пользователя в БД
- `findUserByPkId` - поиск пользователя в БД по id
- `findRegisteredUser` - поиск пользователя
- `findAuthenticatedUser` - поиск пользователя
- `findUserByEmail` - поиск пользователя по email
- `findListUsers` - поиск списка пользователей 
- `removeUser` - удаление пользователя из бд